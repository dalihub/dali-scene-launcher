CMAKE_MINIMUM_REQUIRED(VERSION 2.6)
PROJECT(model-exporter C CXX)

SET(ROOT_SRC_DIR ${CMAKE_SOURCE_DIR}/../..)

SET(PREFIX ${CMAKE_INSTALL_PREFIX})
SET(BINDIR ${PREFIX}/bin)

SET(PKG_LIST assimp )

INCLUDE(FindPkgConfig)
pkg_check_modules(REQUIRED_PKGS REQUIRED ${PKG_LIST})

FOREACH(flag ${REQUIRED_PKGS_CFLAGS})
        SET(REQUIRED_CFLAGS "${REQUIRED_CFLAGS} ${flag}")
ENDFOREACH(flag)

SET(MODEL_EXPORTER_CLI_SRC_DIR ${ROOT_SRC_DIR}/model-exporter-cli)
SET(MODEL_EXPORTER_CORE_SRC_DIR ${ROOT_SRC_DIR}/model-exporter-core/src)
SET(MODEL_EXPORTER_CORE_INC_DIR ${ROOT_SRC_DIR}/model-exporter-core/include)

SET( COMMON_SRCS
       ${MODEL_EXPORTER_CLI_SRC_DIR}/main.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/Animation3D.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/Camera3D.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/LoadScene.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/Node3D.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/SaveScene.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/Scene3D.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/Vector2.cpp
       ${MODEL_EXPORTER_CORE_SRC_DIR}/Vector3.cpp
   )

INCLUDE_DIRECTORIES(${MODEL_EXPORTER_CORE_INC_DIR})


SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${REQUIRED_CFLAGS} -Werror -Wall -fPIE -std=c++11")
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${CMAKE_C_FLAGS}")

ADD_EXECUTABLE(${PROJECT_NAME} ${COMMON_SRCS})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${REQUIRED_PKGS_LDFLAGS} -pie)

INSTALL(TARGETS ${PROJECT_NAME} DESTINATION ${BINDIR})

